{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/web.timers.js\";\nimport { onBeforeUnmount, onMounted, watch, shallowRef, computed } from 'vue';\nimport KeyCode from '../../_util/KeyCode';\nimport { addGlobalMousedownEvent, getTargetFromEvent } from '../utils/uiUtil';\nimport raf from '../../_util/raf';\nexport default function usePickerInput(_ref) {\n  var open = _ref.open,\n    value = _ref.value,\n    isClickOutside = _ref.isClickOutside,\n    triggerOpen = _ref.triggerOpen,\n    forwardKeydown = _ref.forwardKeydown,\n    _onKeydown = _ref.onKeydown,\n    blurToCancel = _ref.blurToCancel,\n    onSubmit = _ref.onSubmit,\n    onCancel = _ref.onCancel,\n    _onFocus = _ref.onFocus,\n    _onBlur = _ref.onBlur;\n  var typing = shallowRef(false);\n  var focused = shallowRef(false);\n  /**\n   * We will prevent blur to handle open event when user click outside,\n   * since this will repeat trigger `onOpenChange` event.\n   */\n  var preventBlurRef = shallowRef(false);\n  var valueChangedRef = shallowRef(false);\n  var preventDefaultRef = shallowRef(false);\n  var inputProps = computed(function () {\n    return {\n      onMousedown: function onMousedown() {\n        typing.value = true;\n        triggerOpen(true);\n      },\n      onKeydown: function onKeydown(e) {\n        var preventDefault = function preventDefault() {\n          preventDefaultRef.value = true;\n        };\n        _onKeydown(e, preventDefault);\n        if (preventDefaultRef.value) return;\n        switch (e.which) {\n          case KeyCode.ENTER:\n            {\n              if (!open.value) {\n                triggerOpen(true);\n              } else if (onSubmit() !== false) {\n                typing.value = true;\n              }\n              e.preventDefault();\n              return;\n            }\n          case KeyCode.TAB:\n            {\n              if (typing.value && open.value && !e.shiftKey) {\n                typing.value = false;\n                e.preventDefault();\n              } else if (!typing.value && open.value) {\n                if (!forwardKeydown(e) && e.shiftKey) {\n                  typing.value = true;\n                  e.preventDefault();\n                }\n              }\n              return;\n            }\n          case KeyCode.ESC:\n            {\n              typing.value = true;\n              onCancel();\n              return;\n            }\n        }\n        if (!open.value && ![KeyCode.SHIFT].includes(e.which)) {\n          triggerOpen(true);\n        } else if (!typing.value) {\n          // Let popup panel handle keyboard\n          forwardKeydown(e);\n        }\n      },\n      onFocus: function onFocus(e) {\n        typing.value = true;\n        focused.value = true;\n        if (_onFocus) {\n          _onFocus(e);\n        }\n      },\n      onBlur: function onBlur(e) {\n        if (preventBlurRef.value || !isClickOutside(document.activeElement)) {\n          preventBlurRef.value = false;\n          return;\n        }\n        if (blurToCancel.value) {\n          setTimeout(function () {\n            var _document = document,\n              activeElement = _document.activeElement;\n            while (activeElement && activeElement.shadowRoot) {\n              activeElement = activeElement.shadowRoot.activeElement;\n            }\n            if (isClickOutside(activeElement)) {\n              onCancel();\n            }\n          }, 0);\n        } else if (open.value) {\n          triggerOpen(false);\n          if (valueChangedRef.value) {\n            onSubmit();\n          }\n        }\n        focused.value = false;\n        if (_onBlur) {\n          _onBlur(e);\n        }\n      }\n    };\n  });\n  // check if value changed\n  watch(open, function () {\n    valueChangedRef.value = false;\n  });\n  watch(value, function () {\n    valueChangedRef.value = true;\n  });\n  var globalMousedownEvent = shallowRef();\n  // Global click handler\n  onMounted(function () {\n    globalMousedownEvent.value = addGlobalMousedownEvent(function (e) {\n      var target = getTargetFromEvent(e);\n      if (open.value) {\n        var clickedOutside = isClickOutside(target);\n        if (!clickedOutside) {\n          preventBlurRef.value = true;\n          // Always set back in case `onBlur` prevented by user\n          raf(function () {\n            preventBlurRef.value = false;\n          });\n        } else if (!focused.value || clickedOutside) {\n          triggerOpen(false);\n        }\n      }\n    });\n  });\n  onBeforeUnmount(function () {\n    globalMousedownEvent.value && globalMousedownEvent.value();\n  });\n  return [inputProps, {\n    focused: focused,\n    typing: typing\n  }];\n}","map":{"version":3,"names":["onBeforeUnmount","onMounted","watch","shallowRef","computed","KeyCode","addGlobalMousedownEvent","getTargetFromEvent","raf","usePickerInput","_ref","open","value","isClickOutside","triggerOpen","forwardKeydown","onKeydown","blurToCancel","onSubmit","onCancel","onFocus","onBlur","typing","focused","preventBlurRef","valueChangedRef","preventDefaultRef","inputProps","onMousedown","e","preventDefault","which","ENTER","TAB","shiftKey","ESC","SHIFT","includes","document","activeElement","setTimeout","_document","shadowRoot","globalMousedownEvent","target","clickedOutside"],"sources":["C:/Users/zhouy/WebstormProjects/lingo/node_modules/ant-design-vue/es/vc-picker/hooks/usePickerInput.js"],"sourcesContent":["import { onBeforeUnmount, onMounted, watch, shallowRef, computed } from 'vue';\nimport KeyCode from '../../_util/KeyCode';\nimport { addGlobalMousedownEvent, getTargetFromEvent } from '../utils/uiUtil';\nimport raf from '../../_util/raf';\nexport default function usePickerInput(_ref) {\n  let {\n    open,\n    value,\n    isClickOutside,\n    triggerOpen,\n    forwardKeydown,\n    onKeydown,\n    blurToCancel,\n    onSubmit,\n    onCancel,\n    onFocus,\n    onBlur\n  } = _ref;\n  const typing = shallowRef(false);\n  const focused = shallowRef(false);\n  /**\n   * We will prevent blur to handle open event when user click outside,\n   * since this will repeat trigger `onOpenChange` event.\n   */\n  const preventBlurRef = shallowRef(false);\n  const valueChangedRef = shallowRef(false);\n  const preventDefaultRef = shallowRef(false);\n  const inputProps = computed(() => ({\n    onMousedown: () => {\n      typing.value = true;\n      triggerOpen(true);\n    },\n    onKeydown: e => {\n      const preventDefault = () => {\n        preventDefaultRef.value = true;\n      };\n      onKeydown(e, preventDefault);\n      if (preventDefaultRef.value) return;\n      switch (e.which) {\n        case KeyCode.ENTER:\n          {\n            if (!open.value) {\n              triggerOpen(true);\n            } else if (onSubmit() !== false) {\n              typing.value = true;\n            }\n            e.preventDefault();\n            return;\n          }\n        case KeyCode.TAB:\n          {\n            if (typing.value && open.value && !e.shiftKey) {\n              typing.value = false;\n              e.preventDefault();\n            } else if (!typing.value && open.value) {\n              if (!forwardKeydown(e) && e.shiftKey) {\n                typing.value = true;\n                e.preventDefault();\n              }\n            }\n            return;\n          }\n        case KeyCode.ESC:\n          {\n            typing.value = true;\n            onCancel();\n            return;\n          }\n      }\n      if (!open.value && ![KeyCode.SHIFT].includes(e.which)) {\n        triggerOpen(true);\n      } else if (!typing.value) {\n        // Let popup panel handle keyboard\n        forwardKeydown(e);\n      }\n    },\n    onFocus: e => {\n      typing.value = true;\n      focused.value = true;\n      if (onFocus) {\n        onFocus(e);\n      }\n    },\n    onBlur: e => {\n      if (preventBlurRef.value || !isClickOutside(document.activeElement)) {\n        preventBlurRef.value = false;\n        return;\n      }\n      if (blurToCancel.value) {\n        setTimeout(() => {\n          let {\n            activeElement\n          } = document;\n          while (activeElement && activeElement.shadowRoot) {\n            activeElement = activeElement.shadowRoot.activeElement;\n          }\n          if (isClickOutside(activeElement)) {\n            onCancel();\n          }\n        }, 0);\n      } else if (open.value) {\n        triggerOpen(false);\n        if (valueChangedRef.value) {\n          onSubmit();\n        }\n      }\n      focused.value = false;\n      if (onBlur) {\n        onBlur(e);\n      }\n    }\n  }));\n  // check if value changed\n  watch(open, () => {\n    valueChangedRef.value = false;\n  });\n  watch(value, () => {\n    valueChangedRef.value = true;\n  });\n  const globalMousedownEvent = shallowRef();\n  // Global click handler\n  onMounted(() => {\n    globalMousedownEvent.value = addGlobalMousedownEvent(e => {\n      const target = getTargetFromEvent(e);\n      if (open.value) {\n        const clickedOutside = isClickOutside(target);\n        if (!clickedOutside) {\n          preventBlurRef.value = true;\n          // Always set back in case `onBlur` prevented by user\n          raf(() => {\n            preventBlurRef.value = false;\n          });\n        } else if (!focused.value || clickedOutside) {\n          triggerOpen(false);\n        }\n      }\n    });\n  });\n  onBeforeUnmount(() => {\n    globalMousedownEvent.value && globalMousedownEvent.value();\n  });\n  return [inputProps, {\n    focused,\n    typing\n  }];\n}"],"mappings":";;;AAAA,SAASA,eAAe,EAAEC,SAAS,EAAEC,KAAK,EAAEC,UAAU,EAAEC,QAAQ,QAAQ,KAAK;AAC7E,OAAOC,OAAO,MAAM,qBAAqB;AACzC,SAASC,uBAAuB,EAAEC,kBAAkB,QAAQ,iBAAiB;AAC7E,OAAOC,GAAG,MAAM,iBAAiB;AACjC,eAAe,SAASC,cAAcA,CAACC,IAAI,EAAE;EAC3C,IACEC,IAAI,GAWFD,IAAI,CAXNC,IAAI;IACJC,KAAK,GAUHF,IAAI,CAVNE,KAAK;IACLC,cAAc,GASZH,IAAI,CATNG,cAAc;IACdC,WAAW,GAQTJ,IAAI,CARNI,WAAW;IACXC,cAAc,GAOZL,IAAI,CAPNK,cAAc;IACdC,UAAS,GAMPN,IAAI,CANNM,SAAS;IACTC,YAAY,GAKVP,IAAI,CALNO,YAAY;IACZC,QAAQ,GAINR,IAAI,CAJNQ,QAAQ;IACRC,QAAQ,GAGNT,IAAI,CAHNS,QAAQ;IACRC,QAAO,GAELV,IAAI,CAFNU,OAAO;IACPC,OAAM,GACJX,IAAI,CADNW,MAAM;EAER,IAAMC,MAAM,GAAGnB,UAAU,CAAC,KAAK,CAAC;EAChC,IAAMoB,OAAO,GAAGpB,UAAU,CAAC,KAAK,CAAC;EACjC;AACF;AACA;AACA;EACE,IAAMqB,cAAc,GAAGrB,UAAU,CAAC,KAAK,CAAC;EACxC,IAAMsB,eAAe,GAAGtB,UAAU,CAAC,KAAK,CAAC;EACzC,IAAMuB,iBAAiB,GAAGvB,UAAU,CAAC,KAAK,CAAC;EAC3C,IAAMwB,UAAU,GAAGvB,QAAQ,CAAC;IAAA,OAAO;MACjCwB,WAAW,EAAE,SAAAA,YAAA,EAAM;QACjBN,MAAM,CAACV,KAAK,GAAG,IAAI;QACnBE,WAAW,CAAC,IAAI,CAAC;MACnB,CAAC;MACDE,SAAS,EAAE,SAAAA,UAAAa,CAAC,EAAI;QACd,IAAMC,cAAc,GAAG,SAAjBA,cAAcA,CAAA,EAAS;UAC3BJ,iBAAiB,CAACd,KAAK,GAAG,IAAI;QAChC,CAAC;QACDI,UAAS,CAACa,CAAC,EAAEC,cAAc,CAAC;QAC5B,IAAIJ,iBAAiB,CAACd,KAAK,EAAE;QAC7B,QAAQiB,CAAC,CAACE,KAAK;UACb,KAAK1B,OAAO,CAAC2B,KAAK;YAChB;cACE,IAAI,CAACrB,IAAI,CAACC,KAAK,EAAE;gBACfE,WAAW,CAAC,IAAI,CAAC;cACnB,CAAC,MAAM,IAAII,QAAQ,CAAC,CAAC,KAAK,KAAK,EAAE;gBAC/BI,MAAM,CAACV,KAAK,GAAG,IAAI;cACrB;cACAiB,CAAC,CAACC,cAAc,CAAC,CAAC;cAClB;YACF;UACF,KAAKzB,OAAO,CAAC4B,GAAG;YACd;cACE,IAAIX,MAAM,CAACV,KAAK,IAAID,IAAI,CAACC,KAAK,IAAI,CAACiB,CAAC,CAACK,QAAQ,EAAE;gBAC7CZ,MAAM,CAACV,KAAK,GAAG,KAAK;gBACpBiB,CAAC,CAACC,cAAc,CAAC,CAAC;cACpB,CAAC,MAAM,IAAI,CAACR,MAAM,CAACV,KAAK,IAAID,IAAI,CAACC,KAAK,EAAE;gBACtC,IAAI,CAACG,cAAc,CAACc,CAAC,CAAC,IAAIA,CAAC,CAACK,QAAQ,EAAE;kBACpCZ,MAAM,CAACV,KAAK,GAAG,IAAI;kBACnBiB,CAAC,CAACC,cAAc,CAAC,CAAC;gBACpB;cACF;cACA;YACF;UACF,KAAKzB,OAAO,CAAC8B,GAAG;YACd;cACEb,MAAM,CAACV,KAAK,GAAG,IAAI;cACnBO,QAAQ,CAAC,CAAC;cACV;YACF;QACJ;QACA,IAAI,CAACR,IAAI,CAACC,KAAK,IAAI,CAAC,CAACP,OAAO,CAAC+B,KAAK,CAAC,CAACC,QAAQ,CAACR,CAAC,CAACE,KAAK,CAAC,EAAE;UACrDjB,WAAW,CAAC,IAAI,CAAC;QACnB,CAAC,MAAM,IAAI,CAACQ,MAAM,CAACV,KAAK,EAAE;UACxB;UACAG,cAAc,CAACc,CAAC,CAAC;QACnB;MACF,CAAC;MACDT,OAAO,EAAE,SAAAA,QAAAS,CAAC,EAAI;QACZP,MAAM,CAACV,KAAK,GAAG,IAAI;QACnBW,OAAO,CAACX,KAAK,GAAG,IAAI;QACpB,IAAIQ,QAAO,EAAE;UACXA,QAAO,CAACS,CAAC,CAAC;QACZ;MACF,CAAC;MACDR,MAAM,EAAE,SAAAA,OAAAQ,CAAC,EAAI;QACX,IAAIL,cAAc,CAACZ,KAAK,IAAI,CAACC,cAAc,CAACyB,QAAQ,CAACC,aAAa,CAAC,EAAE;UACnEf,cAAc,CAACZ,KAAK,GAAG,KAAK;UAC5B;QACF;QACA,IAAIK,YAAY,CAACL,KAAK,EAAE;UACtB4B,UAAU,CAAC,YAAM;YACf,IAAAC,SAAA,GAEIH,QAAQ;cADVC,aAAa,GAAAE,SAAA,CAAbF,aAAa;YAEf,OAAOA,aAAa,IAAIA,aAAa,CAACG,UAAU,EAAE;cAChDH,aAAa,GAAGA,aAAa,CAACG,UAAU,CAACH,aAAa;YACxD;YACA,IAAI1B,cAAc,CAAC0B,aAAa,CAAC,EAAE;cACjCpB,QAAQ,CAAC,CAAC;YACZ;UACF,CAAC,EAAE,CAAC,CAAC;QACP,CAAC,MAAM,IAAIR,IAAI,CAACC,KAAK,EAAE;UACrBE,WAAW,CAAC,KAAK,CAAC;UAClB,IAAIW,eAAe,CAACb,KAAK,EAAE;YACzBM,QAAQ,CAAC,CAAC;UACZ;QACF;QACAK,OAAO,CAACX,KAAK,GAAG,KAAK;QACrB,IAAIS,OAAM,EAAE;UACVA,OAAM,CAACQ,CAAC,CAAC;QACX;MACF;IACF,CAAC;EAAA,CAAC,CAAC;EACH;EACA3B,KAAK,CAACS,IAAI,EAAE,YAAM;IAChBc,eAAe,CAACb,KAAK,GAAG,KAAK;EAC/B,CAAC,CAAC;EACFV,KAAK,CAACU,KAAK,EAAE,YAAM;IACjBa,eAAe,CAACb,KAAK,GAAG,IAAI;EAC9B,CAAC,CAAC;EACF,IAAM+B,oBAAoB,GAAGxC,UAAU,CAAC,CAAC;EACzC;EACAF,SAAS,CAAC,YAAM;IACd0C,oBAAoB,CAAC/B,KAAK,GAAGN,uBAAuB,CAAC,UAAAuB,CAAC,EAAI;MACxD,IAAMe,MAAM,GAAGrC,kBAAkB,CAACsB,CAAC,CAAC;MACpC,IAAIlB,IAAI,CAACC,KAAK,EAAE;QACd,IAAMiC,cAAc,GAAGhC,cAAc,CAAC+B,MAAM,CAAC;QAC7C,IAAI,CAACC,cAAc,EAAE;UACnBrB,cAAc,CAACZ,KAAK,GAAG,IAAI;UAC3B;UACAJ,GAAG,CAAC,YAAM;YACRgB,cAAc,CAACZ,KAAK,GAAG,KAAK;UAC9B,CAAC,CAAC;QACJ,CAAC,MAAM,IAAI,CAACW,OAAO,CAACX,KAAK,IAAIiC,cAAc,EAAE;UAC3C/B,WAAW,CAAC,KAAK,CAAC;QACpB;MACF;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;EACFd,eAAe,CAAC,YAAM;IACpB2C,oBAAoB,CAAC/B,KAAK,IAAI+B,oBAAoB,CAAC/B,KAAK,CAAC,CAAC;EAC5D,CAAC,CAAC;EACF,OAAO,CAACe,UAAU,EAAE;IAClBJ,OAAO,EAAPA,OAAO;IACPD,MAAM,EAANA;EACF,CAAC,CAAC;AACJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}